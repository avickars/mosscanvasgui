<HTML>
<HEAD>
<TITLE>courses/Sandbox__diana__63020711/APIAssignment/submissions/Mary_Doe/</TITLE>
</HEAD>
<BODY BGCOLOR=white>
<HR>
courses/Sandbox__diana__63020711/APIAssignment/submissions/Mary_Doe/<p><PRE>
&gt;&gt;&gt;&gt; file: courses/Sandbox__diana__63020711/APIAssignment/submissions/Mary_Doe/MaryDoe_mossScatterPlotVizualization.py
<A NAME="0"></A><FONT color = #FF0000><A HREF="match0-1.html#0" TARGET="1"><IMG SRC="../bitmaps/tm_0_99.gif" ALT="other" BORDER="0" ALIGN=left></A>

import sys
from bs4 import BeautifulSoup
import pandas as pd
import codecs
import plotly.graph_objects as go
import statistics as stat

def sections(arg):
    if arg&gt;80:
        return '80%'
    elif arg&lt;=80 and arg&gt;60:
        return '60% - 80%'
    elif arg&lt;=60 and arg&gt;45:
        return '45% - 60%'
    elif arg&lt;=45 and arg&gt;30:
        return '30% - 45%'
    elif arg &lt;=30 and arg&gt;15:
        return '15% - 30%'
    else:
        return '0% - 15%'


# Getting Moss html report
htmlFile = codecs.open("/home/aidan/Documents/SFU Summer 2020 Co-op/DianaWork/C120 2020-1-timed-CW2_MOSS/All Together/mossReport.html", 'r')

# Setting the destination of the report
destination = "/home/aidan/Documents/SFU Summer 2020 Co-op/DianaWork/C120 2020-1-timed-CW2_MOSS/All Together/"

plotTitle = "All Questions"

fileName = "allQuestions_Scatterplot.html"

# Reading html into a beautiful soup object
soup = BeautifulSoup(htmlFile.read(), features="lxml")

# Finding the table rows
dataHTML = soup.find('table').find_all('tr')

# Creating the dataframe to score the information
data = pd.DataFrame(columns=["student1","student1_percent","student2","student2_percent","numLines"])

# Scraping the report
for dataIndv in dataHTML:
    dataByLine = dataIndv.find_all('a')
    numLines = dataIndv.find_all('td', {'align': 'right'})
    # Testing for an empty list
    if not dataByLine:
        continue
    s1 = dataByLine[0].contents[0]
    s2 = dataByLine[1].contents[0]
    newData = {"student1":s1[0:s1.find('(')],
               "student1_percent":int(s1[s1.find('(')+1:s1.find('%')]),
               "student2":s2[0:s2.find('(')],
               "student2_percent":int(s2[s2.find('(')+1:s2.find('%')]),
               "numLines":int(numLines[0].contents[0])}
    data = data.append(newData,ignore_index=True)

if plotTitle == "":
    plotTitle = "Moss Assignment Similarity Breakdown"


fig = go.Figure(go.Scatter(
    x = data["student1_percent"],
    y = data["student2_percent"],
    mode = 'markers',
    hovertemplate = 'Student 1: %{x}% &lt;br&gt; Student 2: %{y}% &lt;extra&gt;&lt;/extra&gt;',
    marker_color = 'darkred'
))

fig.update_layout(
    xaxis = dict(
        title = "Student 1 (Similarity Percentage)"
    ),
    yaxis = dict(
        title = "Student 2 (Similarity Percentage)"
    ),
    title = plotTitle
)
fig.write_html(destination + fileName)
</FONT></PRE>
</PRE>
</BODY>
</HTML>
